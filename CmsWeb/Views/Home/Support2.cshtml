@{
    ViewBag.Title = "Support";
    Layout = ViewExtensions2.Layout();
    var active = TempData["ActiveRecords"].ToInt();
    var usenewlook = ViewExtensions2.UseNewLook();
    var admin = User.IsInRole("Admin");
}
@section scripts
{
    @ViewExtensions2.CKEditor()
    @Fingerprint.Script("/Scripts/js/Support2.js")
}
@if (admin)
{
    if (usenewlook)
    {
        <div style="text-align: right"><a class="bt" href="/APITest/UseOldLook">Use Old Look</a></div>
    }
    else
    {
        <div style="text-align: right"><a class="bt" href="/APITest/UseNewLook">Use New Look</a></div>
    }
}
<form>
    <table class="center roundbox" width="500">
        <tr> <td> <h2>Need help using this software?</h2> </td></tr>
        <tr> <td> Try searching our documentation first. If that doesn't help then click the Contact Support button... </td> </tr>
        <tr> <td> Enter search terms here: <input type="text" id="cse-search-input-box-id" size="25" autocomplete="off" /> </td> </tr>
        <tr>
            <td class="right">
                <input id="csearch" type="submit" class="bt green" value="Search Documentation" />
                <input id="contactsupport" type="button" class="bt blue" value="Contact Support" />
            </td>
        </tr>
    </table>
</form>
<table class="center" width="800">
    <tr>
        <td>
            <gcse:searchresults-only></gcse:searchresults-only>
        </td>
    </tr>
</table>
<table id="supportForm" class="center" style="display:none; width:700px">
    <tr>
        <td>
            <div id="examples">
                <h3>Example of a good support request</h3>
                <div>
                    <p>Hello!</p>
                    <p>
                        I am looking at John Doe’s record (people ID # 1015).  He is a member of the Adult
                        Choir (Org ID # 27), but I can’t mark him present for a choir meeting several weeks
                        ago (6/23/13 at 9:30 AM).  Can you please look into this issue for me?
                    </p>
                    <p>
                        Thank you!<br />
                        Mary Smith
                    </p>
                </div>
                <h3>Example of a good bug report</h3>
                <div>
                    <p>Hello!</p>
                    <p>
                        I am on John Doe’s record (people ID # 1015).  I was trying to look at his enrollments
                        tab, but as soon as I click on “Enrollment”, I get an error message, that says
                        “Object not set to an instance of an object”. Can you please look into this for me?<br />
                    </p>
                    <p>
                        Thank you!<br />
                        Mary Smith
                    </p>
                </div>
            </div>
            <form style="margin-top: 1.5em;">
                <input id="supportLastSearch" type="hidden" name="search" value="" />
                <textarea name="request" id="reqBody"></textarea>
                <br />
                <p>Enter comma separated e-mail addresses to copy the request.</p>
                <p>
                    CC: <input type="text" name="cc" size="60" />
                    <select name="urgency" id="supportUrgency">
                        <option value="0" selected="">-- Please select an urgency for your request...</option>
                        <option>No Rush. This can wait until tomorrow</option>
                        <option>I just need an answer before tomorrow morning</option>
                        <option>Urgent, I need an answer ASAP</option>
                    </select>
                    <input id="sendSupport" type="button" class="bt blue" value="Submit Request">
                </p>
            </form>
        </td>
    </tr>
</table>
<table id="about" class="roundbox center">
    <tr>
        <td class="center">
            <h2>
                @if (Util.IsHosted)
                {
                    <text>Open Source Software,<br />Hosting and Support Provided By</text>
                }
                else
                {
                    <text>Open Source Software Provided By</text>
                }
            </h2>
            <br /><br />
            <span class="center"><a href="http://www.bvcms.com"><img src="/Content/images/bvcms150.png" /></a></span>
            <br /><br />
            <div>Build Date: @Util.BuildDate()</div>
            <br /><br />
            <div>
                @if (active > 0)
                {
                    @:Active Records: @active.ToString("N0")
                }
                else if (User.IsInRole("Admin"))
                {
                    @Helper.AnchorLink("See Active Records", "javascript:$.block();window.location='/Home/ActiveRecords';")
                }
            </div>
        </td>
    </tr>
</table>
<table id="success" class="roundbox center" width="500">
    <tr><td>Your support request has been submitted. Thank you for contacting us. We will get back with you as soon as possible.</td></tr>
</table>
