@model CmsWeb.Models.OnlineRegModel
@using UtilityExtensions
@if (Util.UrgentMessage.HasValue())
{
<div class="alert alert-warning"><strong>@Util.UrgentMessage</strong></div>
}
@Html.Raw(Model.Instructions)
@Html.Partial("Flow/ModelHidden", Model)

@if (Model.DisplayLogin()) // nobody registered yet
{
    @Html.Partial("Flow2/Login", Model)
}
else
{
    if (!Model.OnlyOneAllowed() && Model.List.Count > 1) // label is necessary if more than one
    {
        <div class="instruct">Pending Registrations</div>
    }
    for (var i = 0; i < Model.List.Count; i++) // show each registrant, including the one being worked on
    {
        var viewdata = new ViewDataDictionary(ViewData) { TemplateInfo = new TemplateInfo { HtmlFieldPrefix = "List[" + i + "]" } };
        @Html.Partial("Flow2/Registrant", Model.List[i], viewdata)
    }
    if (Model.last != null 
        && Model.last.OtherOK 
        && Model.last.ShowDisplay()) //show the buttons if we are ready to move on
    {
        @Html.Partial("Flow2/Buttons", Model)
    }
}