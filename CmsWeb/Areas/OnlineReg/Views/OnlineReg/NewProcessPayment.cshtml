@using UtilityExtensions
@using CmsWeb
@model CmsWeb.Models.PaymentForm
@{
    Layout = "/Views/Shared/onlinereg.cshtml";
    ViewBag.Title = "Online Registration";
}
@section scripts
{
@Html.Script("/Scripts/OnlineRegPayment.js")
    <script type="text/javascript">
        $(function () {
            $(document).bind("idle.idleTimer", function () {
                window.location.href = '@Model.ti.Url';
            });
            var tmout = parseInt('@ViewData["timeout"]');
            $.idleTimer(tmout);
        });
    </script>
}
    <h2>
        Payment Processing</h2>
@if (ViewData.ContainsKey("Terms"))
{ 
    <a id="displayterms" title="click to display terms" href="#">Display Terms</a>
    <div id="Terms" title="Terms of Agreement" class="modalPopup" style="display: none;
        width: 400px; padding: 10px">
        @ViewData["Terms"]</div>
    <p>
        @Html.CheckBox("IAgree")
        I agree to the above terms and conditions.</p>
    <p>
        You must agree to the terms above for you or your minor child before you can continue.</p>
} 
@if (Model.AllowCoupon)
{
	<form action="/OnlineReg/PayWithCoupon/@Model.ti.DatumId" method="post">
		<p>
			If you have received a Cash Payment Code, please enter that number here and click
			the button below it:</p>
		<input id="Coupon" name="Coupon" type="password" value="@ViewData["Coupon"]" autocomplete="off" /><br /> 
		<input type="button" href="/OnlineReg/PayWithCoupon/@Model.ti.DatumId" class="submitbutton ajax" 
			   value="Apply Coupon" />
		<div>@Html.ValidationMessage("coupon")</div>
	</form>
}
    <form action="/onlinereg/ProcessPayment/@Model.ti.DatumId" method="post">
    @Html.Hidden("pf.ti.DatumId", Model.ti.DatumId)
    @Html.Hidden("pf.ti.Amt", Model.ti.Amt)
    @Html.Hidden("pf.ti.Url", Model.ti.Url)
    <table>
    <tr><td>Name</td><td>@Html.TextBox("pf.ti.Name", Model.ti.Name)</td></tr>
    <tr><td>Address</td><td>@Html.TextBox("pf.ti.Address", Model.ti.Address)</td></tr>
    <tr><td>City</td><td>@Html.TextBox("pf.ti.City", Model.ti.City)</td></tr>
    <tr><td>State</td><td>@Html.TextBox("pf.ti.State", Model.ti.State)</td></tr>
    <tr><td>Zip</td><td>@Html.TextBox("pf.ti.Zip", Model.ti.Zip)</td></tr>
    <tr><td>Phone</td><td>@Html.TextBox("pf.ti.Phone", Model.ti.Phone)</td></tr>
    <tr><td>Amount to Pay</td><td>@Model.ti.Amt.ToString2("N")</td></tr>
    <tr><td>CreditCard</td><td>@Html.TextBox("pf.CreditCard")</td></tr>
    <tr><td>CCV</td><td>@Html.TextBox("pf.CCV")</td></tr>
    <tr><td>Expires</td><td>@Html.TextBox("pf.Expires")</td></tr>
    </table>
    <p>
        <input id="Submit" type="submit" name="Submit" value="Make Payment" /><br />
        @Html.ValidationMessage("form")
        </p>
    </form>


