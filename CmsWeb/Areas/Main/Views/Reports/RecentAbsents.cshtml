@model IEnumerable<CmsData.View.RecentAbsent>
@using UtilityExtensions
@{
    ViewBag.Title = "RecentAbsents";
    Layout = "~/Views/Shared/SiteLayout.cshtml";
    var prevorgid = 0;
}
<h2>Recent Absents</h2>
<table class="grid table-striped">
@foreach (var item in Model) 
{
    if (item.OrganizationId != prevorgid)
    {
        prevorgid = item.OrganizationId;
    <tr>
        <td colspan="5"><hr/>
            <a href="/Organization/Index/@item.OrganizationId">@item.OrganizationName</a> (@item.LeaderName) <br/>
            Members with @item.ConsecutiveAbsentsThreshold or more consecutive absents on and before @item.Lastmeeting.Value.ToShortDateString()
            <hr/>
        </td>
    </tr>
    }
    <tr>
        <td><a href="/Person/Index/@item.PeopleId" target="person">@item.Name2</a></td>
        <td align="right"> @item.Consecutive times </td>
        <td>@item.HomePhone.FmtFone(prefix:"H")</td>
        <td>@item.CellPhone.FmtFone(prefix:"C")</td>
        <td><a href="mailto:@item.EmailAddress">@item.EmailAddress</a></td>
    </tr>
}
</table>