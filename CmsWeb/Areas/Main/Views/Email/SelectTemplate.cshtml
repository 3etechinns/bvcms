@model CmsWeb.Areas.Main.Models.EmailTemplates
@{
    ViewBag.Title = "SelectTemplate";
    Layout = "~/Views/Shared/SiteLayout.cshtml";
	 const int WRAP_COUNT = 3;
	 var wrapAt = WRAP_COUNT;
}
@section head {
	<style type="text/css">
		div.templateItem { width:100px; height:150px; border:1px solid black; overflow:hidden; }
		div.templateItem:hover { border-color:#0000ff; }
	</style>
}
@section scripts
{
	<script type="text/javascript">
		$(document).ready(function () {
			$("[bvtemplate]").on("click", function (e) {
				$("#templateID").val($(this).attr("template"));
				$("#selectTemplate").submit();
			});
		});
	</script>
}
<h2>Select An e-Mail Option</h2>
<table width="100%" cellspacing="10">
<tr>
	<td width="20%" valign="top">

		<center>
		Use Blank Template
		<hr />
		<table width="100%" cellspacing="20">
		<tr>
			<td align="center">
				Blank<br />
				<div bvtemplate class="templateItem" template="0">
                    Click this to not use a template. You will compose your email the old way in this case.
				</div>
			</td>
		</tr>
		</table>
		</center>

	</td>
	<td width="50%" valign="top">

		<center>
		Use a Template
		<hr />
		</center>
		<form id="selectTemplate" action="/Email/Index/@ViewBag.queryID" method="post">
			<input type="hidden" id="templateID" name="templateID" value="0" />
			<input type="hidden" name="parents" value="@ViewBag.parents" />
		</form>
		<table width="100%" cellspacing="20">
		<tr>
		@foreach (var t in Model.fetchTemplates())
		{
			<td width="@( 100/WRAP_COUNT )%" align="center">
				@t.Name<br />
				<div bvtemplate class="templateItem" template="@t.Id">
				@if (t.ThumbID != 0)
				{
					<img alt="portrait" border="0" src="/Image.aspx?id=@t.ThumbID" />
				}
				</div>
			</td>
			wrapAt--;
			if( wrapAt == 0 ) {
				wrapAt = WRAP_COUNT;
				@:</tr><tr>
			}
		}
		@for (var i = 0; i < wrapAt; i++)
		{
			<td>&nbsp;</td>
		}
		</tr>
		</table>

	</td>
	<td valign="top">
		
		<center>
		Use a Saved Draft
		<hr />
		</center>
		<table width="100%" cellspacing="10">
		<tr>
		@foreach (var t in Model.fetchDrafts())
		{
			<td>
				<a href="#" bvtemplate>@t.Name</a>
			</td>
		}
		</tr>
		</table>


	</td>
</tr>
</table>
