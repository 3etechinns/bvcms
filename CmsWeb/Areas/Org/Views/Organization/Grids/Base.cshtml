@using CmsData
@using CmsData.Codes
@using CmsWeb
@using UtilityExtensions
@model CmsWeb.Areas.Org.Models.MemberModel
<div class="pagination pagination-mini">
  @Html.Partial("Pager3", Model)
  <a id="refresh-current" href="#" class="ajax-refresh pull-right"><i class="fa fa-refresh"></i></a>
</div>
<table id="MemberGrid" class="@ViewExtensions2.GridClass">
  <thead>
    <tr>
      <th><br />@Model.SortLink("Name")</th>
      <th><br />@Model.SortLink("MemberType")</th>
      <th class="left">
        @Model.SortLink("Church")<br />
        @Model.SortLink("Age") - @Model.SortLink("Bday")
      </th>
      <th><br />@Model.SortLink("Primary Address")</th>
      <th><br />Communication</th>
      <th>
        @Model.SortLink("% Att.")
        <br />Last Contact
      </th>
      <th>
        @Model.SortLink("Joined")<br />
        @Model.SortLink("Last Att.")
      </th>
      <th><br />Tag</th>
    </tr>
  </thead>
  <tbody>
    @foreach (var om in Model.ViewList())
    {
      <tr>
        <td><img src="/Content/images/individual.gif" border="0" /> <a href="/Person2/@om.PeopleId">@om.Name</a></td>
        <td>
          <a class="membertype" href="/OrgMemberDialog2/Display/@Model.OrganizationId/@om.PeopleId"> @om.MemberType </a>
        </td>
        <td>
          @om.MemberStatus<br />
          @om.Age - @om.BirthDate
        </td>
        <td>
          <a href="http://www.google.com/maps?q=@om.Address,+@om.CityStateZip" target="_blank">
            @om.Address
          </a><br />
          @om.CityStateZip
        </td>
        <td>
          @foreach (var ph in om.Phones)
          {
            @ph<br />
          }
          <a href="mailto:@om.EmailAddress">@om.EmailAddress</a>
        </td>
        <td>
          <a href="">@om.AttendPct.ToString2("N1")%</a>
          @*
            @if (om.LastContactDt.HasValue)
            {
              <br/><a href="/Contact2/@om.LastContactId" target="contact">@om.LastContactDt.FormatDate2()</a>
            }
            @if (om.TaskAboutId.HasValue)
            {
              <br/><a href="/Task/@om.TaskAboutId" target="contact" title="@om.TaskAboutDt.FormatDate2()">Task</a> @:Task
            }
            @if (om.TaskAboutId.HasValue)
            {
              <br/><a href="/Task/@om.TaskAboutId" target="contact" title="@om.TaskAboutDt.FormatDate2()">Task</a> @:Task
            }
          *@
        </td>
        <td>
          @om.Joined.FormatDate2()<br />
          @if (om.LastAttended.HasValue)
          {
            <a href="/Organization/GotoMeetingForDate/@Model.OrganizationId/@om.LastAttended.Value.Ticks">@om.LastAttended.FormatDate2()</a><br />
          }
          @if (Model.GroupSelect == GroupSelectCode.Prospect)
          {
            if (om.Hidden)
            {
              <a href="/Organization/ShowProspect/@Model.OrganizationId/@om.PeopleId/Show" class="joinlink"
                 confirm="Show @om.Name in Prospect List for this Org?">Show</a>
            }
            else
            {
              <a href="/Organization/ShowProspect/@Model.OrganizationId/@om.PeopleId/Hide" class="joinlink"
                 confirm="Hide @om.Name on Prospect List for this Org?">Hide</a>
            }
          }
        </td>
        <td>
          <a pid='@om.PeopleId' title="Add to/Remove from Active Tag" class="taguntag" href="#">@(om.HasTag ? "Remove" : "Add")</a>
        </td>
      </tr>
    }
  </tbody>
</table>
<div class="pagination pagination-mini">
  @Html.Partial("Pager3", Model)
  <a id="refresh-current" href="#" class="ajax-refresh pull-right"><i class="fa fa-refresh"></i></a>
</div>

