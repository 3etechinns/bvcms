@using CmsData
@using CmsWeb
@using UtilityExtensions
@model CmsWeb.Areas.Org.Models.MemberModel
<table id="MemberGrid" class="@ViewExtensions2.GridClass" cellpadding="4">
<thead>
<tr>
    <th><br /><a href="#" class="sortable">Name</a></th>
    <th><br /><a title="Sort by Organization Member Type" href="#" class="sortable">MemberType</a></th>
    <th class="left">
        <a title="Sort by Church Member Status" href="#" class="sortable">Church</a><br />
        <a href="#" class="sortable">Age</a> - <a title="Sort by Birthday" href="#" class="sortable">Bday</a>
    </th>
    <th><br /><a href="#" class="sortable">Primary Address</a></th>
    <th><br />Communication</th>
      <th>
        <a href="#" class="sortable">% Att.</a>
        <br/>Last Contact
      </th>
      <th>
        <a href="#" class="sortable">Joined</a><br />
        <a href="#" class="sortable">Last Att.</a>
    </th>
    <th><br />Tag</th>
</tr>
</thead>
<tbody>
    @foreach (var om in Model.Members())
{ 
<tr>
    <td><img src="/Content/images/individual.gif" border="0" /> <a href="/Person2/@om.PeopleId">@om.Name</a></td>
    <td>
        <a class="membertype" href="/OrgMemberDialog/Display/@Model.OrganizationId/@om.PeopleId"> @om.MemberType </a>
    </td>
        <td>
          @om.MemberStatus<br />
        @om.Age - @om.BirthDate
    </td>
        <td>
          <a href="http://www.google.com/maps?q=@om.Address,+@om.CityStateZip" target="_blank">
            @om.Address
          </a><br />
        @om.CityStateZip
    </td>
    <td>
    @foreach (var ph in om.Phones)
    {     
        @ph<br />
    }         
        <a href="mailto:@om.EmailAddress">@om.EmailAddress</a>
    </td>
    <td>
        <span>@om.AttendPct.ToString2("N1")%</span>
    </td>
  <td>
    @om.Joined.FormatDate2()<br />
    @if (om.LastAttended.HasValue)
    {
      <a href="/Organization/GotoMeetingForDate/@Model.OrganizationId/@om.LastAttended.Value.Ticks">@om.LastAttended.FormatDate2()</a>
    }
  </td>

    <td>
          <a pid='@om.PeopleId' title="Add to/Remove from Active Tag" class="taguntag" href="#">@(om.HasTag ? "Remove" : "Add")</a>
    </td>
</tr>
}
</tbody>
</table>
 @Html.Partial("Pager2", Model.Pager) 
