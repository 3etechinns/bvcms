@using System.Web.Optimization
@using CmsWeb;
@using CmsData;
@using UtilityExtensions;
@model CmsWeb.Models.CheckinTimeModel
@{
	ViewBag.Title = "Check-in Activity";
	Layout = "/Views/Shared/SiteLayout.cshtml";
}
@section head {
	<style type="text/css">
		.ui-timepicker-div .ui-widget-header { margin-bottom: 8px; }
		.ui-timepicker-div dl { text-align: left; }
		.ui-timepicker-div dl dt { height: 25px; margin-bottom: -25px; }
		.ui-timepicker-div dl dd { margin: 0 10px 10px 65px; }
		.ui-timepicker-div td { font-size: 90%; }
		.ui-tpicker-grid-label { background: none; border: none; margin: 0; padding: 0; }
		tr.host { font-weight: bold; }
	</style>
}
@section scripts
{
    @Scripts.Render("~/bundles/single/checkinactivity-js")
}
<form id="form" method="post" action="/Manage/CheckinTime/Index">
@Html.Hidden("peopleid")
<div class="roundbox floatleft">
	<h2>
		Check-in Activity</h2>
	<table cellspacing="7">
		<tr>
			<td align="right">Start Date: </td>
			<td>@Html.DatePicker("dateStart")</td>
			<td align="right">@Html.CheckBox("withGuest", Model.withGuest )</td>
			<td>Show With Guest</td>
		</tr>
		<tr>
			<td align="right">End Date: </td>
			<td>@Html.DatePicker("dateEnd")</td>
			<td align="right">Name:</td>
            <td>
				<span class="name">@Model.counts.name</span>
                <a id="clearname" href="#">(Clear)</a>
			</td>
		</tr>
		<tr>
			<td align="right">Locations: </td>
			<td>@Html.DropDownList( "location", new SelectList(Model.Locations()) )</td>
			<td colspan="2">&nbsp;</td>
		</tr>
		<tr>
			<td align="right">Activity: </td>
			<td>@Html.DropDownList( "activity", new SelectList( Model.Activities()))</td>
			<td colspan="2" align="center">
				Members: <span class="membercount">@Model.counts.members</span> - 
                Guests: <span class="guestcount">@Model.counts.guests</span>
			</td>
		</tr>
		<tr>
			<td align="right" colspan="4"><a id="filter" href="#" class="submitbutton bt">Filter</a> <a id="clear" href="#" class="submitbutton bt">Clear</a></td>
		</tr>
	</table>
</div>
<div class="roundbox floatleft" style="margin-left:10px;">
	<h2>Check-in Totals</h2>
	<table cellspacing="7">
		@foreach (var t in Model.FetchActivityCount())
		{
		<tr>
			<td align="right">@t.name:</td>
			<td>@t.count</td>
		</tr>
		} 
	</table>
</div>
<div class="floatclear">
</div>
<table id="Checkins" class="grid" cellpadding="5">
	<thead>
		<tr><td colspan="3"><hr /></td></tr>
		<tr>
			<th align="left"><a href="#" class="sortable">Host</a> / <a href="#" class="sortable">Person</a></th>
			<th><a href="#" class="sortable">Date/Time</a></th>
			<th><a href="#" class="sortable">Activity</a></th>
		</tr>
	</thead>
    <tbody>
    	@foreach (var t in Model.FetchTimes()) 
{
	<tr class="@t.rowclass()">
		<td class="@t.indent()"><a href="#" person id="@t.ctime.PeopleId">@t.name</a></td>
		<td>@t.ctime.CheckInTimeX.FormatDateTm()</td>
		<td>@t.activities</td>
	</tr>
}
	<tr><td colspan="3">
			@Html.Hidden("membercount", Model.counts.members)
			@Html.Hidden("guestcount", Model.counts.guests)
			@Html.Hidden("name", Model.counts.name)
			@{Html.RenderPartial("Pager2", Model.Pager);}
		</td>
	</tr>
    </tbody>
</table>
</form>
