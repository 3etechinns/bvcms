function RefreshList(n){$.ajax({type:"POST",url:"/Query/Results/",data:n,timeout:12e5,success:function(n){$("#toolbar").show();$("#results").html(n);$("#people tbody tr:even").addClass("alt");$("a.taguntag").click(function(n){return $.post("/Query/ToggleTag/"+$(this).attr("value"),function(t){t.error?alert(t.error):$(n.target).text(t.HasTag?"Remove":"Add")}),!1});$("#people thead a.sortable").click(function(){var n=$(this).text(),i=$("#Sort").val(),t;return $("#Sort").val(n),t=$("#Direction").val(),i==n&&t=="asc"?$("#Direction").val("desc"):$("#Direction").val("asc"),RefreshList(),!1})},error:function(n,t,i){alert(i)}})}function ShowErrors(j){$(".validate").each(function(){$(this).next(".error").remove()});var e=eval("("+j+")");return e.count==0?!1:($(".validate").each(function(){e[this.id]&&$(this).after("<span class='error'> "+e[this.id]+"<\/span>")}),!0)}$(function(){var n,t,i;$.postQuery=function(n,t,i){$.isFunction(t)&&(i=t,t=undefined);t!==undefined&&$("#SelectedId").val(t);var r=$("#query-form").serialize();$.post("/Query/"+n,r,i)};t=$('<div class="modal-backdrop hide" />').appendTo("body");$("#conditions").on("click","a.edit-popover",function(){return n=$(this).closest("li.condition"),i(),!1});i=function(t){var i=n.data("qid");$("#editcondition").attr("originalheight",n.height());$("#editcondition").is(":visible")&&$.HideEditCondition();$.postQuery("EditCondition",i,function(n){$("#editcondition .popover-content").html(n).ready(function(){$.AdjustEditCondition(t)})})};$("#SaveAs").click(function(n){n.preventDefault();var t=this.href;$("<div />").load("/Query/SaveAs",{id:$("#QueryId").val(),nametosaveas:$("#SaveToDescription").val()},function(){var t=$(this),n=t.find("form");n.modal("show");n.on("hidden",function(){t.remove();n.remove()})})});$.AdjustEditCondition=function(i){$("#editcondition .date").datepicker({autoclose:!0,orientation:"auto"});$("#editcondition select").multiselect({includeSelectAllOption:!0,enableFiltering:!0,enableCaseInsensitiveFiltering:!0});var u=$("#editcondition").outerHeight(),r=n.position(),f=n.width();$("#editcondition").css({left:r.left,top:r.top+2,"min-width":f,"z-index":1041});t.removeClass("hide");n.animate({height:u},350);setTimeout(function(){$("#editcondition").slideDown(500,function(){$(this).scrollintoview();i&&i.isnew&&$("#SelectCondition").click()})},10)};$.HideEditCondition=function(){var n,i;t.addClass("hide");n=$("#editcondition").attr("originalheight");$("#editcondition").slideUp(150);i=$("li[data-qid='"+$("#SelectedId").val()+"']");i.animate({height:n},400,function(){$("#editcondition .popover-content").empty()})};$("#CancelChange").live("click",function(){return $.HideEditCondition(),!1});$("#conditions header").live("mouseenter",function(){var n=$(this).closest("li");n.addClass("borderleftred")});$("#conditions header").live("mouseleave",function(){var n=$(this).closest("li");n.removeClass("borderleftred")});$("#SaveCondition").live("click",function(){return $.postQuery("SaveCondition",function(n){n.startsWith("<fieldset")?$("#editcondition .popover-content").html(n).ready(function(){$.InitCodeValues()}):($.HideEditCondition(),$("#conditions").html(n).ready(function(){RefreshList()}))}),!1});$("#editForm input").live("keydown",function(n){if(n.keyCode==13)return n.preventDefault(),$("#SaveCondition").click(),!1});$("#conditions select.changegroup").live("change",function(){var i=$(this).val(),t;return n=$(this).closest("li.condition"),t=n.data("qid"),$.postQuery("ChangeGroup/"+i,t,function(){RefreshList()}),!1});$("#conditions a.addnewclause").live("click",function(){n=$(this).closest("li.condition");var t=n.data("qid");return $.postQuery("AddNewCondition",t,function(t){$("#conditions").html(t).ready(function(){n=$("li[data-qid='"+$("#NewId").val()+"']");i({isnew:!0})})}),!1});$("#conditions a.addnewgroup").live("click",function(){n=$(this).closest("li.condition");var t=n.data("qid");return $.postQuery("AddNewGroup",t,function(t){$("#conditions").html(t).ready(function(){n=$("li[data-qid='"+$("#NewId").val()+"']");i({isnew:!0})})}),!1});$.ClipboardHasCondition&&$("li.pastecondition").show();$("#conditions a.cutcondition").live("click",function(){n=$(this).closest("li.condition");var t=n.data("qid");return $(this).parent().parent().prev().dropdown("toggle"),$.postQuery("Cut",t,function(n){$("#conditions").html(n).ready(function(){$("li.pastecondition").show();RefreshList()})}),!1});$("#conditions a.copycondition").live("click",function(){n=$(this).closest("li.condition");var t=n.data("qid");return $.postQuery("Copy",t),$(this).parent().parent().prev().dropdown("toggle"),$("li.pastecondition").show(),!1});$("#conditions a.pastecondition").live("click",function(){n=$(this).closest("li.condition");var t=n.data("qid");return $.postQuery("Paste",t,function(n){$("#conditions").html(n);RefreshList()}),!1});$("#conditions a.insgroupabove").live("click",function(){n=$(this).closest("li.condition");var t=n.data("qid");return $.postQuery("InsGroupAbove",t,function(n){$("#conditions").html(n);RefreshList()}),!1});$("#conditions a.maketopgroup").live("click",function(){n=$(this).closest("li.condition");var t=n.data("qid");return $.postQuery("MakeTopGroup",t,function(n){$("#conditions").html(n);RefreshList()}),!1});$("#conditions a.delete").live("click",function(){n=$(this).closest("li.condition");var t=n.data("qid");return bootbox.confirm("Are you sure you want to delete?",function(n){n===!0&&$.postQuery("RemoveCondition",t,function(n){$("#conditions").html(n);RefreshList()})}),!1});$("#Comparison").live("change",function(){$("#CodeValues").length>0&&$.postQuery("CodeSelect",function(n){$.replaceSelect("#CodeValues",n)})});$("#Tags").click(function(){$("#TagsPopup").show()});$.replaceSelect=function(n,t){$(n).multiselect("destroy").ready(function(){$(n).replaceWith(t).ready(function(){$(n).multiselect({enableFiltering:!0,enableCaseInsensitiveFiltering:!0})})})};$("#Program").live("change",function(){$.postQuery("Divisions/"+$(this).val(),function(n){$.replaceSelect("#Division",n);$.replaceSelect("#Organization","<select id='Organization' name='Organization' style='display:none'><option value='0'>(not specified)<\/option><\/select>")})});$("#Division").live("change",function(){$.postQuery("Organizations/"+$(this).val(),function(n){$.replaceSelect("#Organization",n)})});$("#Run").live("click",function(){return RefreshList(),!1});$("#Export").click(function(){window.location="/Query/Export/"+$("#QueryId").val()});$("#SelectCondition").live("click",function(n){return n.preventDefault(),t.css({"z-index":1042}),$("#QueryConditionSelect").modal("show"),!1});$("#QueryConditionSelect").live("hidden",function(){t.css({"z-index":1040})});$(".FieldLink a").click(function(t){t.preventDefault();var i=n.data("qid");return $("#ConditionName").val(t.target.id),$.postQuery("SelectCondition",i,function(n){$("#QueryConditionSelect").modal("hide");$("#editcondition .popover-content").html(n).ready($.AdjustEditCondition)}),!1});$.navigate=function(n,t){n+=(n.match(/\?/)?"&":"?")+t;window.location=n};$("a.help").live("click",function(n){n.preventDefault();var t="//www.bvcms.com/DocDialog/"+$(this).data("name");t.endsWith("-")&&(t=t+$("#ConditionName").val());$("#helpcontent iframe").attr("src",t).ready(function(){$("#QueryConditionHelp").modal("show")})});$("#NewSearchId").val()?(n=$("li[data-qid='"+$("#NewSearchId").val()+"']"),i({isnew:!0})):$("#AutoRun").val()==="True"&&RefreshList()});
/*
//# sourceMappingURL=Query.min.js.map
*/