/* http://mths.be/smoothscroll v1.5.2 by @mathias */
(function(c,a){var b=(function(){var e=a(c.documentElement),d=a(c.body),f;if(e.scrollTop()){return e}else{f=d.scrollTop();if(d.scrollTop(f+1).scrollTop()==f){return e}else{return d.scrollTop(f)}}}());a.fn.smoothScroll=function(d){d=~~d||400;return this.find('a[href*="#"]').click(function(f){var g=this.hash,e=a(g);if(location.pathname.replace(/^\//,"")===this.pathname.replace(/^\//,"")&&location.hostname===this.hostname){if(e.length){f.preventDefault();b.stop().animate({scrollTop:e.offset().top},d,function(){location.hash=g})}}}).end()}}(document,jQuery));(function(a,d){var c,b;b=d.document;c=(function(){function e(f){this._options=a.extend({name:"tour",container:"body",keyboard:true,storage:d.localStorage,debug:false,backdrop:false,redirect:true,orphan:false,duration:false,basePath:"",template:"<div class='popover'>          <div class='arrow'></div>          <h3 class='popover-title'></h3>          <div class='popover-content'></div>          <div class='popover-navigation'>            <div class='btn-group'>              <button class='btn btn-sm btn-default' data-role='prev'>&laquo; Prev</button>              <button class='btn btn-sm btn-default' data-role='next'>Next &raquo;</button>              <button class='btn btn-sm btn-default' data-role='pause-resume'                data-pause-text='Pause'                data-resume-text='Resume'              >Pause</button>            </div>            <button class='btn btn-sm btn-default' data-role='end'>End tour</button>          </div>        </div>",afterSetState:function(g,h){},afterGetState:function(g,h){},afterRemoveState:function(g){},onStart:function(g){},onEnd:function(g){},onShow:function(g){},onShown:function(g){},onHide:function(g){},onHidden:function(g){},onNext:function(g){},onPrev:function(g){},onPause:function(h,g){},onResume:function(h,g){}},f);this._force=false;this._inited=false;this._steps=[];this.backdrop={overlay:null,$element:null,$background:null,backgroundShown:false,overlayElementShown:false}}e.prototype.setState=function(h,j){var g,i;if(this._options.storage){i=""+this._options.name+"_"+h;try{this._options.storage.setItem(i,j)}catch(f){g=f;if(g.code===DOMException.QUOTA_EXCEEDED_ERR){this.debug("LocalStorage quota exceeded. setState failed.")}}return this._options.afterSetState(i,j)}else{if(this._state==null){this._state={}}return this._state[h]=j}};e.prototype.removeState=function(f){var g;if(this._options.storage){g=""+this._options.name+"_"+f;this._options.storage.removeItem(g);return this._options.afterRemoveState(g)}else{if(this._state!=null){return delete this._state[f]}}};e.prototype.getState=function(f){var g,h;if(this._options.storage){g=""+this._options.name+"_"+f;h=this._options.storage.getItem(g)}else{if(this._state!=null){h=this._state[f]}}if(h===void 0||h==="null"){h=null}this._options.afterGetState(f,h);return h};e.prototype.addSteps=function(j){var i,f,g,h;h=[];for(f=0,g=j.length;f<g;f++){i=j[f];h.push(this.addStep(i))}return h};e.prototype.addStep=function(f){return this._steps.push(f)};e.prototype.getStep=function(f){if(this._steps[f]!=null){return a.extend({id:"step-"+f,path:"",placement:"right",title:"",content:"<p></p>",next:f===this._steps.length-1?-1:f+1,prev:f-1,animation:true,container:this._options.container,backdrop:this._options.backdrop,redirect:this._options.redirect,orphan:this._options.orphan,duration:this._options.duration,template:this._options.template,onShow:this._options.onShow,onShown:this._options.onShown,onHide:this._options.onHide,onHidden:this._options.onHidden,onNext:this._options.onNext,onPrev:this._options.onPrev,onPause:this._options.onPause,onResume:this._options.onResume},this._steps[f])}};e.prototype.init=function(g){var f=this;this._force=g;if(this.ended()){return this._debug("Tour ended, init prevented.")}this.setCurrentStep();this._setupMouseNavigation();this._setupKeyboardNavigation();this._onResize(function(){return f.showStep(f._current)});if(this._current!==null){this.showStep(this._current)}this._inited=true;return this};e.prototype.start=function(f){var g;if(f==null){f=false}if(!this._inited){this.init(f)}if(this._current===null){g=this._makePromise(this._options.onStart!=null?this._options.onStart(this):void 0);return this._callOnPromiseDone(g,this.showStep,0)}};e.prototype.next=function(){var f;if(this.ended()){return this._debug("Tour ended, next prevented.")}f=this.hideStep(this._current);return this._callOnPromiseDone(f,this._showNextStep)};e.prototype.prev=function(){var f;if(this.ended()){return this._debug("Tour ended, prev prevented.")}f=this.hideStep(this._current);return this._callOnPromiseDone(f,this._showPrevStep)};e.prototype.goTo=function(f){var g;if(this.ended()){return this._debug("Tour ended, goTo prevented.")}g=this.hideStep(this._current);return this._callOnPromiseDone(g,this.showStep,f)};e.prototype.end=function(){var g,h,f=this;g=function(i){a(b).off("click.tour-"+f._options.name);a(b).off("keyup.tour-"+f._options.name);a(d).off("resize.tour-"+f._options.name);f.setState("end","yes");f._inited=false;f._force=false;f._clearTimer();if(f._options.onEnd!=null){return f._options.onEnd(f)}};h=this.hideStep(this._current);return this._callOnPromiseDone(h,g)};e.prototype.ended=function(){return !this._force&&!!this.getState("end")};e.prototype.restart=function(){this.removeState("current_step");this.removeState("end");this.setCurrentStep(0);return this.start()};e.prototype.pause=function(){var f;f=this.getStep(this._current);if(!(f&&f.duration)){return}this._paused=true;this._duration-=new Date().getTime()-this._start;d.clearTimeout(this._timer);this._debug("Paused/Stopped step "+(this._current+1)+" timer ("+this._duration+" remaining).");if(f.onPause!=null){return f.onPause(this,this._duration)}};e.prototype.resume=function(){var g,f=this;g=this.getStep(this._current);if(!(g&&g.duration)){return}this._paused=false;this._start=new Date().getTime();this._duration=this._duration||g.duration;this._timer=d.setTimeout(function(){if(f._isLast()){return f.next()}else{return f.end()}},this._duration);this._debug("Started step "+(this._current+1)+" timer with duration "+this._duration);if((g.onResume!=null)&&this._duration!==g.duration){return g.onResume(this,this._duration)}};e.prototype.hideStep=function(h){var g,j,k,f=this;k=this.getStep(h);if(!k){return}this._clearTimer();j=this._makePromise(k.onHide!=null?k.onHide(this,h):void 0);g=function(l){var i;i=a(k.element);if(!(i.data("bs.popover")||i.data("popover"))){i=a("body")}i.popover("destroy");if(k.reflex){i.css("cursor","").off("click.tour-"+f._options.name)}if(k.backdrop){f._hideBackdrop()}if(k.onHidden!=null){return k.onHidden(f)}};this._callOnPromiseDone(j,g);return j};e.prototype.showStep=function(g){var h,j,k,l,f=this;l=this.getStep(g);if(!l){return}k=g<this._current;h=this._makePromise(l.onShow!=null?l.onShow(this,g):void 0);j=function(m){var i,n;f.setCurrentStep(g);n=a.isFunction(l.path)?l.path.call():f._options.basePath+l.path;i=[b.location.pathname,b.location.hash].join("");if(f._isRedirect(n,i)){f._redirect(l,n);return}if(f._isOrphan(l)){if(!l.orphan){f._debug("Skip the orphan step "+(f._current+1)+". Orphan option is false and the element doesn't exist or is hidden.");if(k){f._showPrevStep()}else{f._showNextStep()}return}f._debug("Show the orphan step "+(f._current+1)+". Orphans option is true.")}if(l.backdrop){f._showBackdrop(!f._isOrphan(l)?l.element:void 0)}f._scrollIntoView(l.element,function(){if((l.element!=null)&&l.backdrop){f._showOverlayElement(l.element)}f._showPopover(l,g);if(l.onShown!=null){l.onShown(f)}return f._debug("Step "+(f._current+1)+" of "+f._steps.length)});if(l.duration){return f.resume()}};this._callOnPromiseDone(h,j);return h};e.prototype.setCurrentStep=function(f){if(f!=null){this._current=f;this.setState("current_step",f)}else{this._current=this.getState("current_step");this._current=this._current===null?null:parseInt(this._current,10)}return this};e.prototype._showNextStep=function(){var g,h,i,f=this;i=this.getStep(this._current);h=function(j){return f.showStep(i.next)};g=this._makePromise((i.onNext!=null?i.onNext(this):void 0));return this._callOnPromiseDone(g,h)};e.prototype._showPrevStep=function(){var g,h,i,f=this;i=this.getStep(this._current);h=function(j){return f.showStep(i.prev)};g=this._makePromise((i.onPrev!=null?i.onPrev(this):void 0));return this._callOnPromiseDone(g,h)};e.prototype._debug=function(f){if(this._options.debug){return d.console.log("Bootstrap Tour '"+this._options.name+"' | "+f)}};e.prototype._isRedirect=function(g,f){return(g!=null)&&g!==""&&g.replace(/\?.*$/,"").replace(/\/?$/,"")!==f.replace(/\/?$/,"")};e.prototype._redirect=function(g,f){if(a.isFunction(g.redirect)){return g.redirect.call(this,f)}else{if(g.redirect===true){this._debug("Redirect to "+f);return b.location.href=f}}};e.prototype._isOrphan=function(f){return(f.element==null)||!a(f.element).length||a(f.element).is(":hidden")&&(a(f.element)[0].namespaceURI!=="http://www.w3.org/2000/svg")};e.prototype._isLast=function(){return this._current<this._steps.length-1};e.prototype._showPopover=function(o,l){var f,g,h,j,m,n,k=this;n=a.extend({},this._options);h=a.isFunction(o.template)?a(o.template(l,o)):a(o.template);g=h.find(".popover-navigation");m=this._isOrphan(o);if(m){o.element="body";o.placement="top";h=h.addClass("orphan")}f=a(o.element);h.addClass("tour-"+this._options.name);if(o.options){a.extend(n,o.options)}if(o.reflex){f.css("cursor","pointer").on("click.tour-"+this._options.name,function(){if(k._isLast()){return k.next()}else{return k.end()}})}if(o.prev<0){g.find("*[data-role=prev]").addClass("disabled")}if(o.next<0){g.find("*[data-role=next]").addClass("disabled")}if(!o.duration){g.find("*[data-role='pause-resume']").remove()}o.template=h.clone().wrap("<div>").parent().html();f.popover({placement:o.placement,trigger:"manual",title:o.title,content:o.content,html:true,animation:o.animation,container:o.container,template:o.template,selector:o.element}).popover("show");j=f.data("bs.popover")?f.data("bs.popover").tip():f.data("popover").tip();j.attr("id",o.id);this._reposition(j,o);if(m){return this._center(j)}};e.prototype._reposition=function(f,m){var g,h,i,j,k,l,n;j=f[0].offsetWidth;h=f[0].offsetHeight;n=f.offset();k=n.left;l=n.top;g=a(b).outerHeight()-n.top-f.outerHeight();if(g<0){n.top=n.top+g}i=a("html").outerWidth()-n.left-f.outerWidth();if(i<0){n.left=n.left+i}if(n.top<0){n.top=0}if(n.left<0){n.left=0}f.offset(n);if(m.placement==="bottom"||m.placement==="top"){if(k!==n.left){return this._replaceArrow(f,(n.left-k)*2,j,"left")}}else{if(l!==n.top){return this._replaceArrow(f,(n.top-l)*2,h,"top")}}};e.prototype._center=function(f){return f.css("top",a(d).outerHeight()/2-f.outerHeight()/2)};e.prototype._replaceArrow=function(f,g,h,i){return f.find(".arrow").css(i,g?50*(1-g/h)+"%":"")};e.prototype._scrollIntoView=function(j,i){var f,g,k,l,m,h=this;if(!j){return i()}f=a(j);g=a(d);k=f.offset().top;m=g.height();l=Math.max(0,k-(m/2));this._debug("Scroll into view. ScrollTop: "+l+". Element offset: "+k+". Window height: "+m+".");return a("body").stop().animate({scrollTop:Math.ceil(l)},function(){i();return h._debug("Scroll into view. Animation end element offset: "+(f.offset().top)+". Window height: "+(g.height())+".")})};e.prototype._onResize=function(f,g){return a(d).on("resize.tour-"+this._options.name,function(){clearTimeout(g);return g=setTimeout(f,100)})};e.prototype._setupMouseNavigation=function(){var f=this;f=this;a(b).off("click.tour-"+this._options.name,".popover.tour-"+this._options.name+" *[data-role=next]:not(.disabled)").on("click.tour-"+this._options.name,".popover.tour-"+this._options.name+" *[data-role=next]:not(.disabled)",function(g){g.preventDefault();return f.next()});a(b).off("click.tour-"+this._options.name,".popover.tour-"+this._options.name+" *[data-role=prev]:not(.disabled)").on("click.tour-"+this._options.name,".popover.tour-"+this._options.name+" *[data-role=prev]:not(.disabled)",function(g){g.preventDefault();return f.prev()});a(b).off("click.tour-"+this._options.name,".popover.tour-"+this._options.name+" *[data-role=end]").on("click.tour-"+this._options.name,".popover.tour-"+this._options.name+" *[data-role=end]",function(g){g.preventDefault();return f.end()});return a(b).off("click.tour-"+this._options.name,".popover.tour-"+this._options.name+" *[data-role=pause-resume]").on("click.tour-"+this._options.name,".popover.tour-"+this._options.name+" *[data-role=pause-resume]",function(h){var g;h.preventDefault();g=a(this);g.text(f._paused?g.data("pause-text"):g.data("resume-text"));if(f._paused){return f.resume()}else{return f.pause()}})};e.prototype._setupKeyboardNavigation=function(){var f=this;if(!this._options.keyboard){return}return a(b).on("keyup.tour-"+this._options.name,function(g){if(!g.which){return}switch(g.which){case 39:g.preventDefault();if(f._isLast()){return f.next()}else{return f.end()}break;case 37:g.preventDefault();if(f._current>0){return f.prev()}break;case 27:g.preventDefault();return f.end()}})};e.prototype._makePromise=function(f){if(f&&a.isFunction(f.then)){return f}else{return null}};e.prototype._callOnPromiseDone=function(i,h,g){var f=this;if(i){return i.then(function(j){return h.call(f,g)})}else{return h.call(this,g)}};e.prototype._showBackdrop=function(f){if(this.backdrop.backgroundShown){return}this.backdrop=a("<div/>",{"class":"tour-backdrop"});this.backdrop.backgroundShown=true;return a("body").append(this.backdrop)};e.prototype._hideBackdrop=function(){this._hideOverlayElement();return this._hideBackground()};e.prototype._hideBackground=function(){this.backdrop.remove();this.backdrop.overlay=null;return this.backdrop.backgroundShown=false};e.prototype._showOverlayElement=function(h){var f,g,i;if(this.backdrop.overlayElementShown){return}this.backdrop.overlayElementShown=true;g=a(h);f=a("<div/>");i=g.offset();i.top=i.top;i.left=i.left;f.width(g.innerWidth()).height(g.innerHeight()).addClass("tour-step-background").offset(i);g.addClass("tour-step-backdrop");a("body").append(f);this.backdrop.$element=g;return this.backdrop.$background=f};e.prototype._hideOverlayElement=function(){if(!this.backdrop.overlayElementShown){return}this.backdrop.$element.removeClass("tour-step-backdrop");this.backdrop.$background.remove();this.backdrop.$element=null;this.backdrop.$background=null;return this.backdrop.overlayElementShown=false};e.prototype._clearTimer=function(){d.clearTimeout(this._timer);this._timer=null;return this._duration=null};return e})();return d.Tour=c})(jQuery,window);$(function(){$("#split").live("click",function(e){e.preventDefault();var f=$(this).attr("href");bootbox.confirm("Are you sure you want to split this person into their own family?",function(g){if(g===true){$.post(f,{},function(h){window.location=h})}})});$("#deletePerson").live("click",function(e){e.preventDefault();var f=$(this).attr("href");bootbox.confirm("Are you sure you want to delete this record?",function(g){if(g===true){$.post(f,{},function(h){window.location=h})}})});$("a.editaddr").live("click",function(e){e.preventDefault();$("#edit-address").css({"margin-top":"",top:""}).load($(this).attr("href"),{},function(){var f=$(this);f.modal("show");f.on("hidden",function(){$(this).empty()});f.on("click","a.clear-address",function(){$("#AddressLineOne").val("");$("#AddressLineTwo").val("");$("#CityName").val("");$("#ZipCode").val("");$("#BadAddress").prop("checked",false);$("#StateCode_Value").val("");$("#StateCode_Value").trigger("chosen:updated");$("#ResCode_Value").val("0");$("#ResCode_Value").trigger("chosen:updated");$("#Country_Value").val("United States");$("#FromDt").val("");$("#ToDt").val("")});f.on("click","a.close-saved-address",function(){$.post($(this).attr("href"),{},function(g){$("#profile-header").html(g).ready(b)})})})});$("a.personal-picture, a.family-picture").live("click",function(e){e.preventDefault();$("<div />").load($(this).attr("href"),{},function(){var g=$(this);var h=g.find("form");h.modal("show");h.on("hidden",function(){g.remove();h.remove()});$("#delete-picture").click(function(i){i.preventDefault();var f=this;bootbox.confirm("Are you sure you want to delete this picture?",function(j){if(j===true){h.attr("action",f.href);h.submit()}});return false});$("#refresh-thumbnail").click(function(i){i.preventDefault();var f=this;h.attr("action",f.href);h.submit();return false})})});$("#family_related a.edit").live("click",function(e){e.preventDefault();$("<div class='modal fade hide' />").load($(this).attr("href"),{},function(){var f=$(this);f.modal("show");f.on("shown",function(){f.find("textarea").focus()});f.on("hidden",function(){$(this).remove()});f.on("click","a.save",function(g){g.preventDefault();$.post($(this).attr("href"),{value:f.find("textarea").val()},function(h){$("#related-families-div").html(h);f.modal("hide")})});f.on("click","a.delete",function(h){h.preventDefault();var g=$(this);bootbox.confirm("Are you sure you want to remove this relationship?",function(i){if(i===true){$.post(g.attr("href"),{},function(j){$("#related-families-div").html(j);f.modal("hide")})}});return false})})});$("form.ajax a.membertype").live("click",function(e){e.preventDefault();$("#member-dialog").css({"margin-top":"",top:""}).load($(this).attr("href"),{},function(){$(this).modal("show");$(this).on("hidden",function(){$(this).empty()})})});$('a[data-toggle="tab"]').on("shown",function(f){f.preventDefault();var g=$(f.target).attr("href").replace("#","#tab-");window.location.hash=g;$.cookie("lasttab",g);return false});var a=$.cookie("lasttab");if(window.location.hash){a=window.location.hash}if(a){var d=$("a[href='"+a.replace("tab-","")+"']");var c=d.closest("ul").data("tabparent");if(c){$("a[href='#"+c+"']").click().tab("show")}if(d.attr("href")!=="#"){$.cookie("lasttab",d.attr("href"));d.click().tab("show")}}$("a[href='#enrollment']").on("shown",function(f){if($("#current").length<2){$("a[href='#current']").click().tab("show")}});$("a[href='#profile']").on("shown",function(f){var g="#memberstatus";if($(g).length<2){$("a[href='"+g+"']").click().tab("show");$.cookie("lasttab",g)}});$("a[href='#ministry']").on("shown",function(f){var g="#contactsreceived";if($(g).length<2){$("a[href='"+g+"']").click().tab("show");$.cookie("lasttab",g)}});$("a[href='#giving']").on("shown",function(f){var g="#contributions";if($(g).length<2){$("a[href='"+g+"']").click().tab("show");$.cookie("lasttab",g)}});$("a[href='#emails']").on("shown",function(f){var g="#receivedemails";if($(g).length<2){$("a[href='"+g+"']").click().tab("show");$.cookie("lasttab",g)}});$("a[href='#system']").on("shown",function(f){var g="#user";if($(g).length<2){$("a[href='"+g+"']").click().tab("show");$.cookie("lasttab",g)}});$.validator.addMethod("ValidDate",function(h,e,f){var g=$.DateValid(h);return this.optional(e)||g},"Please enter valid date");$("#future").live("click",function(f){f.preventDefault();var e=$(this).closest("div.loaded");var g=e.find("form").serialize();$.post($("#FutureLink").val(),g,function(h){e.html(h)})});$("#addrf").validate();$("#addrp").validate();$("#basic").validate();$("body").on("change",".atck",function(f){var e=$(this);$.post("/Meeting/MarkAttendance/",{MeetingId:$(this).attr("mid"),PeopleId:$(this).attr("pid"),Present:e.is(":checked")},function(g){if(g.error){e.attr("checked",!e.is(":checked"));alert(g.error)}})});$("#vtab>ul>li").click(function(){$("#vtab>ul>li").removeClass("selected");$(this).addClass("selected");var e=$("#vtab>ul>li").index($(this));$("#vtab>div").hide().eq(e).show()});var b=function(){$(".popover-map").dropdown();$("#PositionInFamily").editable({source:[{value:10,text:"Primary Adult"},{value:20,text:"Secondary Adult"},{value:30,text:"Child"}],type:"select",url:"/Person2/PostData",name:"position"});$("#Campus").editable({source:"/Person2/Campuses",type:"select",url:"/Person2/PostData",name:"campus"})};b();$.InitFunctions.Editable=function(){$("a.editable").editable()};$("a.click-pencil").live("click",function(f){f.stopPropagation();$(this).prev().editable("toggle");return false});$("a.visibilityroles").live("click",function(f){f.preventDefault();$(this).editable("toggle");return false});$.InitFunctions.MemberDocsEditable=function(){$("#memberdocs-form a.editable").editable({placement:"right",showbuttons:"bottom"})};$("#failedemails a.unblock").live("click",function(e){if(confirm("are you sure?")){$.post("/Manage/Emails/Unblock",{email:$(this).attr("email")},function(f){$.growlUI("email unblocked",f)})}});$("#failedemails a.unspam").live("click",function(e){if(confirm("are you sure?")){$.post("/Manage/Emails/Unspam",{email:$(this).attr("email")},function(f){$.growlUI("email unspamed",f)})}})});function AddSelected(a){switch(a.from){case"RelatedFamily":$("#related-families-div").loadWith("/Person2/RelatedFamilies/"+a.pid,function(){$(a.key).click()});break;case"Family":$("#family-div").loadWith("/Person2/FamilyMembers/"+a.pid);break;case"MergeTo":window.location="/Merge/{0}/{1}".format(a.pid,a.pid2);break}}function RebindMemberGrids(){$("#refresh-current").click();$("#refresh-pending").click()}function RebindUserInfoGrid(){$.updateTable($("#user-tab form"));$("#memberDialog").dialog("close")}function dialogError(a){return a};$(function(){$("#membergroups .ckbox").live("click",function(a){$.post($(this).attr("href"),{ck:$(this).is(":checked")});return true});$("#dropmember").live("click",function(a){var b=$(this).closest("form");var c=this.href;bootbox.confirm("are you sure?",function(d){if(d){$.post(c,null,function(e){b.modal("hide");self.parent.RebindMemberGrids()})}});return false});$("#OrgSearch").live("keydown",function(a){if(a.keyCode==13){a.preventDefault();$("#orgsearchbtn").click()}});$("a.movemember").live("click",function(a){a.preventDefault();var b=$(this).closest("form");var c=$(this).attr("href");bootbox.confirm("are you sure?",function(d){if(d){$.post(c,null,function(e){b.modal("hide");self.parent.RebindMemberGrids()})}});return false})});