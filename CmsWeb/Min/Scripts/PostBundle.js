function AddSelected(n){$("#searchDialog").dialog("close");var t=$("tr[cid="+n.cid+"]");$("a.pid",t).text(n.pid),$("td.name",t).text(n.name),$("a.edit",t).click()}$(function(){$("#pid").blur(function(){if($(this).val()!=""){var n=$("#pbform").serialize();$.post("/PostBundle/GetName/",n,function(n){n=="not found"?($.growlUI("PeopleId","Not Found"),$("#name").focus(),$("#pid").val("")):($("#name").val(n),$("#amt").focus())})}}),$("td.name").tooltip({showBody:"|"}),$("#name").autocomplete("/PostBundle/Names",{minChars:3,matchContains:!1,mustMatch:!0,width:200,selectFirst:!1,autoFill:!1,formatItem:function(n){return n[0]+" ("+n[2]+")<br />"+n[3]},formatResult:function(n){return n[0]}}),$("#name").result(function(n,t){t&&$("#pid").val(t[1]),this.value===""&&($.growlUI("Name","Not Found"),$("#pid").val(""))}),$.Stripe=function(){$("#bundle tbody tr").removeClass("alt"),$("#bundle tbody tr:even").addClass("alt")},$.Stripe(),$("#notes").keydown(function(n){n.keyCode!=9&&n.keyCode!=13||n.shiftKey||(n.preventDefault(),$.PostRow())}),$("#pid").keydown(function(n){n.keyCode==13&&(n.preventDefault(),$.browser.msie||$("#pid").blur(),$("#name").focus())}),$("#name").keydown(function(n){n.keyCode==13&&(n.preventDefault(),$("#amt").focus())}),$("#amt").keydown(function(n){n.keyCode==13&&(n.preventDefault(),$("#fund").focus())}),$("#fund").keydown(function(n){n.keyCode==13&&(n.preventDefault(),$("#notes").focus())}),$("a.update").click(function(n){n.preventDefault(),$.PostRow()}),$("a.edit").live("click",function(n){var t,i;n.preventDefault(),t=$(this).closest("tr"),$("#editid").val(t.attr("cid")),$("#pid").val($("a.pid",t).text()),$("#name").val($("td.name",t).text()),$("#fund").val($("td.fund",t).attr("val")),$("#pledge").attr("checked",$("td.fund",t).attr("pledge")=="true"),i=$("#amt"),i.val($("td.amt",t).attr("val")),$("#fund").val($("td.fund",t).attr("val")),$("#notes").val($("td.notes",t).text()),t.remove(),i.val()=="0.00"&&i.val(""),i.focus(),$("a.edit").hide(),$.Stripe()}),$("a.delete").live("click",function(n){var i,t;n.preventDefault(),confirm("are you sure?")&&(i=$(this).closest("tr"),$("#editid").val(i.attr("cid")),t=$("#pbform").serialize(),$.post("/PostBundle/DeleteRow/",t,function(n){i.remove(),$("#totalitems").text(n.totalitems),$("#itemcount").text(n.itemcount),$("#editid").val(""),t=$("#pbform").serialize(),$.post("/PostBundle/FundTotals/",t,function(n){$("fundtotals").html(n)})}))}),$("a.pid").live("click",function(n){n.preventDefault();var t=$("#searchDialog");$("iframe",t).attr("src",this.href),t.dialog("open")}),$.MakeEditable=function(){$(".clickEdit").editable("/PostBundle/Edit/",{indicator:"<img src='/images/loading.gif'>",tooltip:"Click to edit...",style:"display: inline",width:"200px",height:25}),$(".clickSelect").editable("/PostBundle/Edit/",{indicator:'<img src="/images/loading.gif">',loadtype:"post",loadurl:"/PostBundle/Funds/",type:"select",submit:"OK",style:"display: inline"})},$.MakeEditable(),$.PostRow=function(){var i=parseFloat($("#amt").val()),n,t;if(!i>0){$.growlUI("Contribution","Cannot post, No Amount");return}n=$("#pbform").serialize(),t="/PostBundle/PostRow/",$("#editid").val()&&(t="/PostBundle/UpdateRow/"),$.post(t,n,function(t){if(t){$("#totalitems").text(t.totalitems),$("#itemcount").text(t.itemcount);var i=$("#pid").val();$("#bundle tbody").prepend('<tr cid="'+t.cid+'"><td><a href="/SearchAdd/Index/'+t.cid+'?type=contributor" class="pid">'+(i||"select")+'</a></td><td class="name" title="'+t.tip+'">'+$("#name").val()+'</td><td class="amt" val="'+$("#amt").val()+'" align="right">'+t.amt+'</td><td val="'+$("#fund").val()+'"class="fund" pledge="'+t.pledge+'"><span id="f'+t.cid+'" class="clickSelect">'+t.fund+'</span></td><td class="notes">'+$("#notes").val()+'</td><td><a class="edit" href="#">edit</a></td><td><a class="delete" href="#">delete</a></td></tr>'),$("#bundle tbody tr:first td.name").tooltip({showBody:"|"}),$("#editid").val(""),$("#entry input").val(""),$("#fund").val($("#fundid").val()),$.MakeEditable(),$("#pid").focus(),$("a.edit").show(),$("a.update").show(),$.Stripe(),n=$("#pbform").serialize(),$.post("/PostBundle/FundTotals/",n,function(n){$("fundtotals").html(n)})}})},$("#searchDialog").dialog({title:"Search/Add Contributor",bgiframe:!0,autoOpen:!1,width:712,height:630,modal:!0,overlay:{opacity:.5,background:"black"},close:function(){$("iframe",this).attr("src","")}})})