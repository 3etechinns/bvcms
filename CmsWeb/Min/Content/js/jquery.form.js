(function(n){function t(){n.fn.ajaxSubmit.debug&&window.console&&window.console.log&&window.console.log("[jquery.form] "+Array.prototype.join.call(arguments,""))}n.fn.ajaxSubmit=function(i){function y(){function s(){var r,v,i,a,e,c;if(!p++){o.detachEvent?o.detachEvent("onload",s):o.removeEventListener("load",s,!1),r=!0;try{if(b)throw"timeout";if(i=o.contentWindow?o.contentWindow.document:o.contentDocument?o.contentDocument:o.document,a=u.dataType=="xml"||i.XMLDocument||n.isXMLDoc(i),t("isXml="+a),!a&&(i.body==null||i.body.innerHTML=="")){if(--w){p=0,setTimeout(s,100);return}t("Could not access iframe DOM after 50 tries.");return}f.responseText=i.body?i.body.innerHTML:null,f.responseXML=i.XMLDocument?i.XMLDocument:i,f.getResponseHeader=function(n){var t={"content-type":u.dataType};return t[n]},u.dataType=="json"||u.dataType=="script"?(e=i.getElementsByTagName("textarea")[0],e?f.responseText=e.value:(c=i.getElementsByTagName("pre")[0],c&&(f.responseText=c.innerHTML))):u.dataType!="xml"||f.responseXML||f.responseText==null||(f.responseXML=k(f.responseText)),v=n.httpData(f,u.dataType)}catch(y){r=!1,n.handleError(u,f,"error",y)}r&&(u.success(v,"success"),h&&n.event.trigger("ajaxSuccess",[f,u])),h&&n.event.trigger("ajaxComplete",[f,u]),h&&!--n.active&&n.event.trigger("ajaxStop"),u.complete&&u.complete(f,r?"success":"error"),setTimeout(function(){l.remove(),f.responseXML=null},100)}}function k(n,t){return window.ActiveXObject?(t=new ActiveXObject("Microsoft.XMLDOM"),t.async="false",t.loadXML(n)):t=(new DOMParser).parseFromString(n,"text/xml"),t&&t.documentElement&&t.documentElement.tagName!="parsererror"?t:null}var e=r[0],f,h,v,w;if(n(":input[name=submit]",e).length){alert('Error: Form elements must not be named "submit".');return}var u=n.extend({},n.ajaxSettings,i),a=n.extend(!0,{},n.extend(!0,{},n.ajaxSettings),u),y="jqFormIO"+ +new Date,l=n('<iframe id="'+y+'" name="'+y+'" src="'+u.iframeSrc+'" />'),o=l[0];if(l.css({position:"absolute",top:"-1000px",left:"-1000px"}),f={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(){this.aborted=1,l.attr("src",u.iframeSrc)}},h=u.global,h&&!n.active++&&n.event.trigger("ajaxStart"),h&&n.event.trigger("ajaxSend",[f,u]),a.beforeSend&&a.beforeSend(f,a)===!1){a.global&&n.active--;return}if(!f.aborted){var p=0,b=0,c=e.clk;c&&(v=c.name,v&&!c.disabled&&(i.extraData=i.extraData||{},i.extraData[v]=c.value,c.type=="image"&&(i.extraData[name+".x"]=e.clk_x,i.extraData[name+".y"]=e.clk_y))),setTimeout(function(){var h=r.attr("target"),c=r.attr("action"),t,f;e.setAttribute("target",y),e.getAttribute("method")!="POST"&&e.setAttribute("method","POST"),e.getAttribute("action")!=u.url&&e.setAttribute("action",u.url),i.skipEncodingOverride||r.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"}),u.timeout&&setTimeout(function(){b=!0,s()},u.timeout),t=[];try{if(i.extraData)for(f in i.extraData)t.push(n('<input type="hidden" name="'+f+'" value="'+i.extraData[f]+'" />').appendTo(e)[0]);l.appendTo("body"),o.attachEvent?o.attachEvent("onload",s):o.addEventListener("load",s,!1),e.submit()}finally{e.setAttribute("action",c),h?e.setAttribute("target",h):r.removeAttr("target"),n(t).remove()}},10),w=50}}var f,s,o,u,w,a,r,e,p,c,l,h,v;if(!this.length)return t("ajaxSubmit: skipping submit process - no element selected"),this;if(typeof i=="function"&&(i={success:i}),f=n.trim(this.attr("action")),f&&(f=(f.match(/^([^#]+)/)||[])[1]),f=f||window.location.href||"",i=n.extend({url:f,type:this.attr("method")||"GET",iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank"},i||{}),s={},this.trigger("form-pre-serialize",[this,i,s]),s.veto)return t("ajaxSubmit: submit vetoed via form-pre-serialize trigger"),this;if(i.beforeSerialize&&i.beforeSerialize(this,i)===!1)return t("ajaxSubmit: submit aborted via beforeSerialize callback"),this;if(o=this.formToArray(i.semantic),i.data){i.extraData=i.data;for(u in i.data)if(i.data[u]instanceof Array)for(w in i.data[u])o.push({name:u,value:i.data[u][w]});else o.push({name:u,value:i.data[u]})}if(i.beforeSubmit&&i.beforeSubmit(o,this,i)===!1)return t("ajaxSubmit: submit aborted via beforeSubmit callback"),this;if(this.trigger("form-submit-validate",[o,this,i,s]),s.veto)return t("ajaxSubmit: submit vetoed via form-submit-validate trigger"),this;for(a=n.param(o),i.type.toUpperCase()=="GET"?(i.url+=(i.url.indexOf("?")>=0?"&":"?")+a,i.data=null):i.data=a,r=this,e=[],i.resetForm&&e.push(function(){r.resetForm()}),i.clearForm&&e.push(function(){r.clearForm()}),!i.dataType&&i.target?(p=i.success||function(){},e.push(function(t){n(i.target).html(t).each(p,arguments)})):i.success&&e.push(i.success),i.success=function(n,t){for(var u=0,f=e.length;u<f;u++)e[u].apply(i,[n,t,r])},c=n("input:file",this).fieldValue(),l=!1,h=0;h<c.length;h++)c[h]&&(l=!0);return v=!1,c.length&&i.iframe!==!1||i.iframe||l||v?i.closeKeepAlive?n.get(i.closeKeepAlive,y):y():n.ajax(i),this.trigger("form-submit-notify",[this,i]),this},n.fn.ajaxForm=function(t){return this.ajaxFormUnbind().bind("submit.form-plugin",function(){return n(this).ajaxSubmit(t),!1}).bind("click.form-plugin",function(t){var r=t.target,f=n(r),e,i,u;if(!f.is(":submit,input:image")){if(e=f.closest(":submit"),e.length==0)return;r=e[0]}i=this,i.clk=r,r.type=="image"&&(t.offsetX!=undefined?(i.clk_x=t.offsetX,i.clk_y=t.offsetY):typeof n.fn.offset=="function"?(u=f.offset(),i.clk_x=t.pageX-u.left,i.clk_y=t.pageY-u.top):(i.clk_x=t.pageX-r.offsetLeft,i.clk_y=t.pageY-r.offsetTop)),setTimeout(function(){i.clk=i.clk_x=i.clk_y=null},100)})},n.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin click.form-plugin")},n.fn.formToArray=function(t){var u=[],r,o,s,l,e,i,f,h,v;if(this.length==0||(r=this[0],o=t?r.getElementsByTagName("*"):r.elements,!o))return u;for(s=0,l=o.length;s<l;s++)if(e=o[s],i=e.name,i){if(t&&r.clk&&e.type=="image"){e.disabled||r.clk!=e||(u.push({name:i,value:n(e).val()}),u.push({name:i+".x",value:r.clk_x},{name:i+".y",value:r.clk_y}));continue}if(f=n.fieldValue(e,!0),f&&f.constructor==Array)for(h=0,v=f.length;h<v;h++)u.push({name:i,value:f[h]});else f!==null&&typeof f!="undefined"&&u.push({name:i,value:f})}if(!t&&r.clk){var a=n(r.clk),c=a[0],i=c.name;i&&!c.disabled&&c.type=="image"&&(u.push({name:i,value:a.val()}),u.push({name:i+".x",value:r.clk_x},{name:i+".y",value:r.clk_y}))}return u},n.fn.formSerialize=function(t){return n.param(this.formToArray(t))},n.fn.fieldSerialize=function(t){var i=[];return this.each(function(){var e=this.name,r,u,f;if(e)if(r=n.fieldValue(this,t),r&&r.constructor==Array)for(u=0,f=r.length;u<f;u++)i.push({name:e,value:r[u]});else r!==null&&typeof r!="undefined"&&i.push({name:this.name,value:r})}),n.param(i)},n.fn.fieldValue=function(t){for(var f,i,u=[],r=0,e=this.length;r<e;r++)(f=this[r],i=n.fieldValue(f,t),i!==null&&typeof i!="undefined"&&(i.constructor!=Array||i.length))&&(i.constructor==Array?n.merge(u,i):u.push(i));return u},n.fieldValue=function(n,t){var a=n.name,r=n.type,s=n.tagName.toLowerCase(),e,f,i,u;if(typeof t=="undefined"&&(t=!0),t&&(!a||n.disabled||r=="reset"||r=="button"||(r=="checkbox"||r=="radio")&&!n.checked||(r=="submit"||r=="image")&&n.form&&n.form.clk!=n||s=="select"&&n.selectedIndex==-1))return null;if(s=="select"){if(e=n.selectedIndex,e<0)return null;var h=[],c=n.options,o=r=="select-one",l=o?e+1:c.length;for(f=o?e:0;f<l;f++)if(i=c[f],i.selected){if(u=i.value,u||(u=i.attributes&&i.attributes.value&&!i.attributes.value.specified?i.text:i.value),o)return u;h.push(u)}return h}return n.value},n.fn.clearForm=function(){return this.each(function(){n("input,select,textarea",this).clearFields()})},n.fn.clearFields=n.fn.clearInputs=function(){return this.each(function(){var n=this.type,t=this.tagName.toLowerCase();n=="text"||n=="password"||t=="textarea"?this.value="":n=="checkbox"||n=="radio"?this.checked=!1:t=="select"&&(this.selectedIndex=-1)})},n.fn.resetForm=function(){return this.each(function(){typeof this.reset!="function"&&(typeof this.reset!="object"||this.reset.nodeType)||this.reset()})},n.fn.enable=function(n){return n==undefined&&(n=!0),this.each(function(){this.disabled=!n})},n.fn.selected=function(t){return t==undefined&&(t=!0),this.each(function(){var r=this.type,i;r=="checkbox"||r=="radio"?this.checked=t:this.tagName.toLowerCase()=="option"&&(i=n(this).parent("select"),t&&i[0]&&i[0].type=="select-one"&&i.find("option").selected(!1),this.selected=t)})}})(jQuery)